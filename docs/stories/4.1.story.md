---
title: Examination & Grading - Tanzania Specific Academic Rules & Calculations
status: Draft
epic: 4
story: 1
---

# User Story: As a Tenant Admin, I want to configure and apply Tanzania-specific academic rules (NECTA) for grading and division calculations, so that my school complies with national standards.

## Acceptance Criteria:
- The system shall allow a Tenant Admin to manage subjects with a `subject_level` (e.g., 'Primary', 'O-Level', 'A-Level') to distinguish curricula.
- For O-Levels, the system shall allow a Tenant Admin to categorize subjects as 'Core' or 'Optional' and enforce rules on the number of optional subjects a student can take.
- The system's division calculation logic for O-Levels shall only use 'Core' subjects, applying the official NECTA grading criteria.
- For A-Levels, the system shall allow a Tenant Admin to group subjects into 'Combinations' (e.g., PCB, HKL) and define 'Recommended' subjects.
- The system's division calculation logic for A-Levels shall only use 'Combination' subjects, applying the specific NECTA A-Level grading criteria.
- The system shall provide a flexible calculation engine that allows for the configuration of which subjects are included in calculations and their respective weightings.
- All Tanzania-specific configurations and calculations shall be isolated by tenant.

## Examples:
- **O-Level Division Calculation Example:** A student takes 7 core subjects and 2 optional subjects. The system will calculate the division based only on the grades of the 7 core subjects, using the NECTA point system (A=1, B=2, ..., F=7) and summing the points of the best 7 subjects.
- **A-Level Combination Example:** A Tenant Admin defines a 'PCB' combination consisting of Physics, Chemistry, and Biology. When a student is enrolled in the 'PCB' combination, the system automatically enforces that they take these three subjects, and the division calculation will be based on their performance in only these subjects.

## Potential Obstacles:
- **Complexity of NECTA Rules:** The NECTA grading and division calculation rules are detailed and can change over time. The system needs a very accurate and up-to-date implementation of these rules. Any misinterpretation could lead to incorrect student evaluations.
- **Future System Changes (GPA vs. Division):** The Tanzanian system might move towards a GPA-based system in the future. The calculation engine must be designed with enough flexibility to accommodate such a major shift without a complete rewrite.
- **Data Migration from Legacy Systems:** Schools may have historical student data in different formats. Migrating this data into the new system and correctly applying the NECTA rules retroactively could be a significant challenge.

## Dev Notes:

### Previous Story Insights:
- Gradebook & Grading System (Story 2.3) provides the basic framework for grades, which this story extends with specific calculation rules.
- Course & Subject Management (Story 2.1) is where the `subject_level` and `subject_type` attributes will be managed.

### Data Models:
- **Subjects Table:** To be extended with `subject_level` ('Primary', 'O-Level', 'A-Level') and `subject_type` ('Core', 'Optional', 'Combination') columns.
- **SubjectCombinations Table:** To define A-Level subject combinations.
- **EnrollmentRules Table:** To store rules about subject selection (e.g., max number of optional subjects).
- **NectaGradingRules Table:** To store the specific point systems and division calculation formulas for O-Level and A-Level.
- **CalculationEngineConfig Table:** To allow for tenant-specific overrides and future flexibility.

## Tasks / Subtasks:
- [ ] Task 1 (AC: 1, 2, 4): Enhance the Subject Management module to include `subject_level`, `subject_type`, and A-Level 'Combinations'.
- [ ] Task 2 (AC: 3, 5): Implement the NECTA-specific division calculation logic for both O-Level and A-Level.
- [ ] Task 3 (AC: 6): Develop the flexible calculation engine, allowing admins to configure and tweak the calculation rules.
- [ ] Task 4 (AC: 7): Ensure strict tenant isolation for all Tanzania-specific configurations.
- [ ] Task 5 (Research): Thoroughly research and document the current and historical NECTA grading and division calculation rules.
- [ ] Task 6 (Testing): Create a comprehensive test suite with a wide range of student data and edge cases to ensure the calculation accuracy.
