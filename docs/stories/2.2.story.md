---
title: Academic Management - Class Scheduling & Timetable Management
status: Draft
epic: 2
story: 2
---

# User Story: As a Tenant Admin, I want to create and manage class schedules and timetables, so that I can organize the academic activities of my school.

## Acceptance Criteria:
- The system shall allow a Tenant Admin to create and manage class schedules for different academic years and terms.
- The system shall allow a Tenant Admin to generate and manage daily and weekly timetables for classes and teachers, with views for both.
- The system shall provide a mechanism to detect and resolve scheduling conflicts (e.g., teacher, classroom, or student group double-booking).
- The system shall consider teacher availability (e.g., part-time, specific workdays) and overall workload when creating timetables.
- The system shall allow for the assignment of classrooms to specific classes and subjects based on room capacity and required facilities.
- The system shall ensure that all scheduling and timetable data is isolated by tenant.
- The generated timetables shall be viewable by students, teachers, and parents.

## Examples:
- **Conflict Detection Example:** The system should flag a conflict if 'Mr. John Doe' is assigned to teach 'Grade 5 - Math' from 9:00-10:00 AM in 'Room 101' and also 'Grade 6 - Science' at the same time in 'Room 202'.
- **Timetable View Example:** A teacher should be able to see their personal weekly timetable in a grid format, showing subjects, classes, and room numbers for each time slot. Similarly, a student should see their class timetable.

## Potential Obstacles:
- **Timetable Generation Complexity:** Developing a fully automated timetable generation algorithm that satisfies all constraints (teacher preferences, student optional subjects, classroom availability, minimizing free periods) is highly complex and computationally intensive. A phased approach, starting with a manual or semi-automated scheduler with conflict detection, is recommended.
- **Real-time Updates:** Propagating real-time changes to timetables (e.g., substitute teacher assignment) to all relevant users (students, parents, other teachers) instantly and reliably can be a technical challenge. This might require WebSocket or similar real-time communication technology.
- **Handling Exceptions:** Managing exceptions like half-days, special events, or exam periods that disrupt the regular timetable requires a flexible system design.

## Dev Notes:

### Previous Story Insights:
- Course & Subject Management (Story 2.1) provides the foundation for academic structure.
- User & Role Management (Story 1.1) ensures that only authorized admins can manage schedules.

### Data Models:
- **Schedules Table:** To store class schedules for different academic years and terms.
- **Timetables Table:** To store daily and weekly timetables for classes and teachers.
- **Classrooms Table:** To store classroom information (e.g., name, capacity, facilities).
- **TeacherAvailability Table:** To store teacher availability, preferences, and workload constraints.
- **ScheduleConflicts Table:** To log detected scheduling conflicts for review.

## Tasks / Subtasks:
- [ ] Task 1 (AC: 1, 5): Implement CRUD operations for Schedules, Classrooms, and Teacher Availability.
- [ ] Task 2 (AC: 2): Develop the interface for creating and managing timetables manually (e.g., a drag-and-drop grid).
- [ ] Task 3 (AC: 3): Implement a robust conflict detection engine that checks for teacher, classroom, and student group clashes in real-time as the schedule is being built.
- [ ] Task 4 (AC: 4): Integrate teacher availability and workload constraints into the timetable creation process.
- [ ] Task 5 (AC: 7): Create read-only timetable views for different user roles (Teacher, Student, Parent).
- [ ] Task 6 (AC: 6): Ensure strict tenant isolation (`tenant_id`) across all database queries and API endpoints related to scheduling.
- [ ] Task 7 (Stretch Goal): Research and design a basic automated timetable suggestion engine.
