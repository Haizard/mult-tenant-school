---
title: Academic Management - Report Card Generation
status: Draft
epic: 2
story: 4
---

# User Story: As a Tenant Admin, I want to generate customizable report cards for students, so that I can communicate their academic progress to parents.

## Acceptance Criteria:
- The system shall allow a Tenant Admin to create and customize report card templates.
- The system shall automatically populate report cards with student grades from individual assessments, attendance data, and teacher comments.
- **The system shall calculate and display a term-end summary on the report card, showing the overall grade which is a weighted average of all assessments within that term, based on the rules defined in the Gradebook & Grading System.**
- The system shall allow for the generation of report cards for individual students, classes, or the entire school.
- The system shall provide an option to include historical academic data on the report card (e.g., performance trends over previous terms).
- The system shall allow for the report cards to be downloaded as PDFs and be printable.
- The system shall ensure that all report card data is isolated by tenant.
- **The system shall provide dedicated report card management panels for each user role with appropriate functionality and restrictions.**
- **Students shall only view their own report cards and cannot access report card generation or other students' reports.**
- **Teachers shall view report cards for their assigned students only and cannot generate or manage report card templates.**
- **Tenant Admins shall have full access to report card generation, template management, and comprehensive report card reports.**
- **Super Admins shall have system-wide view access to report card trends and compliance across all tenants.**

## Examples:
- **Comprehensive Report Card Example:** A Tenant Admin designs a report card template that includes the school's logo, a section for subject-wise grades for each assessment (e.g., Quiz 1: 85%, Mid-Term Exam: 78%), a dedicated area for teacher's remarks, and a summary of attendance. **Crucially, it also features a "Term Performance Summary" section that shows the final, weighted overall grade for each subject (e.g., Math: 77, 'C') and a final grade for the term.**
- **Batch Generation Example:** At the end of a term, the Tenant Admin selects a specific class and generates PDF report cards for all students in that class with a single click.

## Potential Obstacles:
- **Complex Report Layouts:** Designing a user-friendly report card template builder that can accommodate diverse and complex layouts (e.g., multiple columns, tables, charts, and custom branding) can be very challenging. It might require integrating a dedicated report generation library.
- **Performance on Large-Scale Generation:** Generating hundreds or thousands of PDF report cards simultaneously can be a resource-intensive process, potentially leading to slow response times or server timeouts. Asynchronous (background) job processing would likely be necessary.
- **Data Aggregation:** Aggregating all the necessary data for a report card (grades from multiple subjects, attendance records, comments from different teachers, historical data) and **performing the weighted calculations accurately** can be complex from a database query perspective.

## Dev Notes:

### Previous Story Insights:
- Gradebook & Grading System (Story 2.3) provides the core academic data and the **weighted calculation rules** for the report cards.
- Attendance Management (will be covered in a future story) will provide the attendance data.
- User & Role Management (Story 1.1) ensures that only authorized personnel can generate or view report cards.

### Data Models:
- **ReportCardTemplates Table:** To store tenant-defined report card layouts and designs.
- **GeneratedReportCards Table:** To store instances of generated report cards, possibly with a link to the PDF file.

## Role-Based Report Card Management Access Control:

### Super Admin:
- **Access Level**: System-wide read access to report card data across all tenants
- **Permissions**: 
  - View report card trends and patterns across all schools
  - Access system-wide report card reports and analytics
  - Monitor report card compliance and policies across tenants
- **Restrictions**: Cannot generate report cards or manage templates (delegated to tenant admins)

### Tenant Admin:
- **Access Level**: Full CRUD access within their tenant
- **Permissions**:
  - Create and customize report card templates
  - Generate report cards for individual students, classes, or entire school
  - Manage report card policies and configurations
  - View all report cards and generate comprehensive reports
  - Download and print report cards
- **Restrictions**: Cannot access other tenants' report card data

### Teacher:
- **Access Level**: View report cards for assigned students
- **Permissions**:
  - View report cards for their assigned students
  - Access teacher-specific report card reports
  - Add teacher comments to report cards
- **Restrictions**: Cannot generate report cards, manage templates, or view other teachers' students' reports

### Student:
- **Access Level**: Read-only access to own report cards
- **Permissions**:
  - View own report cards
  - Download own report cards as PDF
- **Restrictions**: Cannot access report card generation, other students' reports, or administrative functions

## Tasks / Subtasks:
- [x] Task 1 (AC: 1): Implement a report card template builder interface for Tenant Admins.
- [x] Task 2 (AC: 2, 3): Develop the logic to fetch and aggregate data (grades, attendance, comments) and **calculate the weighted term summary** for report card generation.
- [x] Task 3 (AC: 4, 6): Implement the functionality to generate report cards for individuals or groups and convert them to PDF.
- [x] Task 4 (AC: 5): Add the capability to include historical data in the report cards.
- [x] Task 5 (AC: 7): Ensure strict tenant isolation for all report card data and templates.
- [ ] Task 6 (AC: 8): Implement role-based access control for report card management APIs.
- [ ] Task 7 (AC: 9): Create role-specific report card dashboard components.
- [ ] Task 8 (AC: 10): Implement comprehensive report card data filtering based on user roles.
- [ ] Task 9 (Performance): Investigate and implement an asynchronous process for large-scale report card generation.
